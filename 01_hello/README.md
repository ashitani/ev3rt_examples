# 01_hello

LCDに表示するだけの最低限のアプリです。

## 解説

アプリ作成に最低限必要なのは下記４ファイルです。

| ファイル名 | 説明 |
| --- | --- |
| app.c |ソース |
| app.h |ヘッダファイル |
| app.cfg | 設定ファイル |
| Makefile.inc | ひとまず中身は空で良いです |

app.cfgにはタスクの定義を書きます。各パラメータの意味は下記です。

```
CRE_TSK(タスクID, { タスク属性, タスクの拡張情報, 関数名, 優先度, スタックサイズ, スタックの先頭番地})
```

| パラメータ | 説明 |
| --- | --- |
|タスク属性 | ひとまずTA_ACTとTA_NULLのどちらを書く程度の理解で良さそうです。TA_ACTだと生成時に起動、TA_NULLだと生成時に休止状態|
| 拡張情報 | タスクに渡される情報です（が今は気にしなくていいでしょう）|
| 優先度   | 1から始まって大きいほうが優先度が低くなります |
| スタックサイズ　| スタック領域のサイズです。ひとまず4Kbytesもあればいいでしょう |
| スタックの先頭番地 | スタック領域の先頭番地です。NULLの場合は自動設定？ |

優先度、スタックサイズはapp.hで指定しています。


## タスク関数の書き方

```
  void task(intptr_t exinf)
  {
  タスク本体
  ext_tsk();
  }
```
exinfというのが先程の拡張情報です。ext_tsk()はメインタスクの場合はreturnで代替できます。

## 01_helloでの設定

```
CRE_TSK(MAIN_TASK, { TA_ACT, 0, main_task,  TMIN_APP_TPRI+1, STACK_SIZE, NULL }
```
という設定なので、システム起動時にmain_taskのみが起動します。

TMIN_APP_TRPIはアプリとしては最高の優先度を示します。これより優先度の低いタスクを作るには+で数値を足していけばよいです。